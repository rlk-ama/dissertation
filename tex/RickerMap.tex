\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[fleqn]{amsmath}
\usepackage[T1]{fontenc}
\usepackage{parskip}
\usepackage{booktabs}
\usepackage{mathtools}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{natbib}
\usepackage{textcomp}
\usepackage{booktabs}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{array}
\usepackage{bbold}
\usepackage{amssymb}
\usepackage[procnames]{listings}
\usepackage{color}
\usepackage{graphicx}

\makeatletter
\newcommand{\distas}[1]{\mathbin{\overset{#1}{\kern\z@\sim}}}%
\newsavebox{\mybox}\newsavebox{\mysim}
\newcommand{\distras}[1]{%
	\savebox{\mybox}{\hbox{\kern3pt$\scriptstyle#1$\kern3pt}}%
	\savebox{\mysim}{\hbox{$\sim$}}%
	\mathbin{\overset{#1}{\kern\z@\resizebox{\wd\mybox}{\ht\mysim}{$\sim$}}}%
}
\makeatother

\begin{document}
	\section{Introduction}
	\subsection{The Ricker Map}
	\subsubsection{The Deterministic Ricker Map}
	The Ricker map is a difference equation used to describe the population dynamics of a wide range of ecological populations. It was first described in a seminal paper by Ricker (1954)~\cite{Ricker1954} to account for fish population sizes in fisheries. \\
	If we denote by $N_t$ the size of a population a time $t$, Ricker established that if:
	\begin{itemize}
		\item the average offspring size per individual per unit time is a constant number $r > 0$
		\item there is a crowding effect which reduces by a factor $e^{-\frac{N_t}{K}}$ the offspring size where $K > 0$
		\item generations do not overlap
	\end{itemize}
	then 
	\begin{equation}
		N_{t+1} = r N_t e^{-\frac{N_t}{K}} = f(N_t)
		\label{eq:ricker}
	\end{equation}
	The fact that generations do no overlap, which is generally a strong assumption in biology, is acceptable in the case of seasonally breeding populations, which are widespread in ecology. \\
	This model has very complex dynamics depending on the values of the parameter $r$. It has become a classic discrete population model, and although not taking into account any of the exterior factors which influence greatly ecological populations (such as destruction of natural ecosystems, pervading pollution, etc ...), it provides an accurate description of many experimental population dynamics. \\
	To understand why estimating the parameters of this model given experimental data is non trivial, we first describe its chaotic behaviour. Equation~\ref{eq:ricker} has two equilibria, $N_{eq, 1} = 0$ and $N_{eq, 2} = K\log r$, which are the solutions of  $N_{eq} = r N_{eq} e^{-\frac{N_{eq}}{K}}$. Linearisation around these two equilibria, give $N_{t+1} - N_{eq, 1} = r(N_{t} - N_{eq, 1})$ and $N_{t+1} - N_{eq, 2} = (1-\log r)(N_{t} - N_{eq, 1})$. Therefore $N_{eq, 1}$ is stable when $0 < r < 1$ and unstable when $r > 1$ and $N_{eq, 2}$ is stable when $1 < r < e^2$ and unstable when $r < 1$ or $r > e^2$. The corresponding bifurcation diagram, with $K$ fixed and equal to 1, is shown in Figure~\ref{fig:stability}. Figure~\ref{fig:stab} shows the convergence towards these two equilibria for respectively $r=0.5$ and $r=3$ and $K=10$. It can be noticed that the non zero equilibrium value is close to its theoretical value $10 \log 3 = 10.9$. \\
	Another interesting characteristic of this map, from an ecological point of view, and the reason why it was so widely adopted, resides in the fact that it accounts for scenarii where populations oscillates before reaching an equilibrium. Figure~\ref{fig:oscill} shows such a scenario.\\
	
	Furthermore, the Ricker Map exhibits another remarkable feature. Indeed, when $r$ exceeds $e^2$ there are no stable equilibrium consisting of a single value. After a transient period, they start oscillating among a fixed and finite number of distinct values. The set of these values is called the \emph{orbit}. These values are the fixed points of the equation $f^n(N_t) = N_t$ with $n \in \mathbb{N^*}$. When $r=e^2$ oscillation the orbit consists of 2 values, then of 4 then of 8 and so on until a critical value above which solutions follow an aperiodic pattern. $e^2$ is called a \emph{bifurcation value}, and this geometric progression in the length of the cycles is called a \emph{period doubling cascade}. Figure~\ref{fig:stability} represents the orbit as $r$ grows ($K$ is fixed and equal to 1) and was obtained experimentally. It can be seen that when $r=e^2$ the orbit consists of 2 values and of 8 when $r=2e^2$. Figure~\ref{fig:oscill} shows such an orbit of four values.
	
	As $r$ continues growing, we rapidly reach a situation where population size does not enter any stable orbit any more. This leads to a behaviour characteristic of chaos, where a small change in the value of the parameters or the initial conditions leads to very different solutions. Figure~\ref{fig:chaos} shows the evolution of two populations when either parameter $r$ or initial conditions present a very minor change. It can be noted that populations sizes, in both cases, diverges rapidly from one another.
	
	\subsubsection{The Noisily Observed Ricker Map}
	In order to allow for external factors and to take into account the observational process (for example a counting process), extensions to the deterministic case has been suggested. We chose to proceed with the following model, suggested by Wood (2010)~\cite{Wood2010}.
	\begin{align}
	& N_t = r N_t e^{-N_t+Z_t} \hspace{1cm} Z_t \distas{\mathrm{iid}} \mathrm{N}(0, \sigma^2) \label{noisyRickerState}\\
	& Y_t = \mathrm{Poisson}(\phi N_t)
	\label{noisyRickerObservation}
	\end{align}
	Therefore, $N_t \sim \log\mathcal{N} (\log{(rN_{t-1}e^{-N_{t-1}})},\sigma^2)$, i.e $N_t$ is log-normally distributed with parameters depending on $r$, $K$ and $\sigma$. \\
	The statistical problem at hand is thus to estimate the joint probability of $(r, K, \sigma, \phi, N_{1:T})$ where $T$ is the number of generations. Due to the chaotic dynamics of the Ricker map, estimating the coefficients $r$ and $K$ with precision is important if one wants to obtain simulations exhibiting the same properties as experimental data. Moreover, such an erratic behaviour leads to a highly multimodal likelihood and traditional approaches, such as maximum likelihood estimation, do not suit this parameter estimation problem. \\
	Nonetheless, even if the map were not chaotic, the likelihood is a highly dimensional integral over $N_{0:T}$. Indeed we have:
	\begin{equation}
		L(y{1:T}; \phi, r, \sigma) = \int_{0}^{\infty}p(y_{1:T}, n_{0:T} | \phi, r, \sigma)\mathrm{d}n_{0:T}
	\end{equation}
	and $T$ is ranges typically from 30 to several hundreds.  Therefore numerical integration tools, or Markov Chain Monte Carlo algorithms which require up to a constant calculation of the likelihood, are not suited for this problem.
	
	\subsection{Statistical Methods}
	\subsubsection{State Space Model}
	The noisily observed Ricker Map belongs to the framework of state space models. This framework describes sets of processes which can be decomposed into the following form where $\{x_t ; t \in \mathbb{N}\}$ is a discrete time unobserved process called \emph{states} with $x_t \in \Omega_s$ and $\{y_t ; t \in \mathbb{N^*}\}$ is another discrete time process with $y_t \in \Omega_o$ called \emph{observations}, $\Omega_s$, $\Omega_o$ being samples spaces:
	\begin{align}
		& p(x_0) \\
		& p(x_t | x_{t-1}) \hspace{1cm} t \ge 1\\
		& p(y_t | x_t) \hspace{1cm} t \ge 1
	\end{align}
	Note that we denote by $p(x_t)$ both the probability density of $X_t$ and its distribution if it exists, with respect to an underlying measure $\lambda$. This set of equations means that $X_t$ is a Markov process of initial distribution $p(x_0)$ and transition distribution $p(x_t | x_{t-1})$ and that the observations $y_t$ are assumed to be independent conditionally on $\{x_t ; t \in \mathbb{N}\}$, i.e $p(y_1, \cdots, y_t | x_0, \cdots, x_t) =p(x_0)\Pi_{k=1}^t p(y_k | x_k)$ where $p(y_k | x_k)$ is the marginal distribution of $y_k$. \\
	
	The problems that are usually addressed with state space models are the calculation of the /emph{posterior distribution} $p(x_{1:t}|y_{1:t})$ and of the \emph{filtering distribution} $p(x_t|y_{1:t})$,  where $p(x_{1:}) \coloneqq p(x_1, \cdots, x_t)$ for ease of notation. 
	Even though we have $p(x_{1:t}|y_{1:t}) = \frac{p(y_{1:t}|x_{1:t})p(x_{1:t})}{p(y_{1:t})}$ the denominator is again a highly dimensional, almost always intractable, integral. \\
	One approach is to approximate the distribution $p(x_{1:t}|y_{1:t})$ with the following empirical distribution:
	\begin{equation}
		\hat{p}(x_{0:t}|y_{1:t}) = \sum_{i=1}^{N}\tilde{w}_t^{(i)} \delta_{x_{0:t}^{(i)}}(x_{0:t})
	\end{equation}
	where $\tilde{w}_t^{(i)} = \frac{W(x_{0:t}^{(i)})}{\sum_{j=1}^{N} W(x_{0:t}^{(j)})}$ and $W(x_{0:t}) = \frac{p(x_{1:t}|y_{1:t})}{q(x_{1:t}|y_{1:t})}$ where $x_{0:t}^{(i)}$ are iid draws from $q(x_{1:t}|y_{1:t})$, which is an easy to sample from distribution. If we take any bounded measurable function $\phi$ Geweke (1989)~\cite{Geweke1989} showed that $\mathbb{E}\phi(x_{0:t}) = \sum_{i=1}^{N} \tilde{w}_t^{(i)} \phi(x_{0:t}^{(i)}) \xrightarrow{\mathrm{a.s}} \int_{\Omega^n} \phi({x_{1:t}})p(x_{1:t}|y_{1:t})\mathrm{d}x_{0:t}$.
	\begin{figure}[htb]
		\centering
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/stability.pdf}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/bifucdiagram.pdf}
		\end{minipage}
		\caption{\textbf{(left)}Bifurcation diagram of the Ricker map. \textbf{Dotted} lines correspond to unstable equilibria and \textbf{solid} lines to stable ones. \textbf{(right)} Bifurcation diagram of the Ricker Map.}
		\label{fig:stability}
	\end{figure}

	\begin{figure}[htb]
		\centering
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/0value_ricker.pdf}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/stable_ricker.pdf}
		\end{minipage}
		\caption{Convergence towards the equilibria of the Ricker map}
		\label{fig:stab}
	\end{figure}

	\begin{figure}[htb]
		\centering
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/oscill_ricker.pdf}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/4values_ricker.pdf}
		\end{minipage}
		\caption{\textbf{(left)} The population size oscillates before converging towards equilibrium. \textbf{(right)} The population sizes describes an orbit of length four.}
		\label{fig:oscill}
	\end{figure}
	
	\begin{figure}[htb]
		\centering
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/rchange.pdf}
		\end{minipage}
		\begin{minipage}{0.4\textwidth}
			\centering
			\includegraphics[width=0.97\linewidth]{/home/raphael/dissertation/figures/initchange.pdf}
		\end{minipage}
		\caption{\textbf{(left)} Evolution of the population size when \textbf{(black)}$r=50$ and \textbf{(red)}$r=50.1$ with initial value $N_0=7$. \textbf{(right)} Evolution of the population size when \textbf{(black)}$N_0=7$ and \textbf{(red)}$N_0=7.1$ with $r=50$.}
		\label{fig:chaos}
	\end{figure}

	\bibliographystyle{plain}
	\bibliography{mybib}{}
\end{document}